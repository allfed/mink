Bootstrap: docker
From: centos:7

%environment
    export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/mnt/GRASS_program/grass/zstd/zstd-1.5.2/lib

%post
    mkdir -p freetypes
    cd freetypes
    cd ..
    #WOWyum -y update

    # more setup commands
    ##yum install -y git
    yum install -y make
    # WRONG VERSION NOT NEEDED yum install -y cmake
    yum install -y epel-release # needed to install proj and others
    yum install -y less # just for simple viewing of piped command line data
    yum install -y which # to find locations of command files
    yum install -y wget
    #COMMENT
    #COMMENT
    #COMMENT# we're following https://grasswiki.osgeo.org/wiki/Compile_and_Install
    #COMMENT# ^ especially the section "Installation grass78 on a HPC system with
    #COMMENT# Centos 7 and no root privileges"
    #COMMENT# NOT NEEDEDyum install -y openssl 
    #COMMENT
    #COMMENTyum install -y proj # grass dependency, might need more "-y"?
    #COMMENT
    #COMMENT#yum install -y zstd#not needed?
    #COMMENT#NOT NEEDEDnot needed?:export PATH=/usr/bin/make:$PATH
    yum install -y gcc
    yum install -y byacc
    #COMMENT./configure CC=gcc# is this necessary?
    #COMMENTyum install flex bison make zlib-devel gcc-c++ gettext \
                #COMMENTsqlite-devel mesa-libGL-devel mesa-libGLU-devel \
                #COMMENTlibXmu-devel libX11-devel fftw-devel libtiff-devel \
                #COMMENTlesstif-devel python-devel numpy wxPython wxGTK-devel \
                #COMMENTproj proj-devel proj-epsg proj-nad libxml2 gdal gdal-devel geos #COMMENTgeos-devel \
                #COMMENTnetcdf netcdf-devel blas-devel lapack-devel atlas-devel \
                #COMMENTpython-dateutil python-imaging python-matplotlib python-sphinx \
                #COMMENTdoxygen subversion
    #COMMENT
    mkdir -p freetypes
    #COMMENTcd freetypes
    #COMMENTwget -nc https://download.savannah.gnu.org/releases/freetype/#COMMENTfreetype-2.9.1.tar.gz
    #COMMENTtar -xf freetype-2.9.1.tar.gz
    #COMMENTcd ..
    #COMMENT
    #COMMENTmkdir -p zstd
    #COMMENTcd zstd
    #COMMENTwget -nc https://github.com/facebook/zstd/releases/download/v1.5.2/#COMMENTzstd-1.5.2.tar.gz
    #COMMENTtar -xf zstd-1.5.2.tar.gz
    #COMMENTcd zstd-1.5.2
    #COMMENTmake install PREFIX=./
    #COMMENTcd ..
    #COMMENTcd ..
    #COMMENT
    #COMMENTmkdir -p fftw
    #COMMENTcd fftw
    #COMMENTwget -nc https://www.fftw.org/fftw-3.3.4.tar.gz
    #COMMENTtar -xf fftw-3.3.4.tar.gz
    #COMMENTcd fftw-3.3.4
    #COMMENTCFLAGS="-fPIC" ./configure
    #COMMENTmake
    #COMMENTmake install
    #COMMENTcd ..
    #COMMENTcd ..
    #COMMENTcd ..
    #COMMENTcd .. # now in the root mink directory
    #COMMENT
    #COMMENTcd GRASS_dependencies
    #COMMENT
    #COMMENTmkdir -p cmake
    #COMMENTcd cmake
    #COMMENTwget -c https://github.com/Kitware/CMake/releases/download/v3.17.0-rc3/#COMMENTcmake-3.17.0-rc3.tar.gz
    #COMMENTtar zxvf cmake-3.17.0-rc3.tar.gz
    #COMMENTcd cmake-3.17.0-rc3
    #COMMENT#!!!NOTE:
    #COMMENT#!!![here, you need to go to the file CMakeCache.txt and search for OpenSSL]
    #COMMENT#!!![CMAKE_USE_OPENSSL:BOOL=ON to CMAKE_USE_OPENSSL:BOOL=OFF] 
    #COMMENT#(MAYBE THIS IS FINE BUT ./bootstrap MIGHT FAIL if don't change?)
    #COMMENT./bootstrap
    #COMMENTgmake
    #COMMENTgmake install
    #COMMENT
    #COMMENTcd GRASS_dependencies/GDAL/
    #COMMENTmkdir -p build
    #COMMENTcd build
    #COMMENT
    #COMMENT./configure \
        #COMMENT-prefix=/mnt/GRASS_program/grass \
        #COMMENT--enable-64bit \
        #COMMENT--with-libs=/usr/lib64/ \
        #COMMENT--with-fftw-includes=/usr/local/lib/ \
        #COMMENT--with-fftw-libs=/usr/local/lib/ \
        #COMMENT--with-freetype-includes=/mnt/GRASS_program/grass/freetypes/#COMMENTfreetype-2.9.1/include/ \
        #COMMENT--with-netcdf --with-geos --with-blas --with-lapack --with-postgres \
        #COMMENT--with-zstd-includes=/mnt/GRASS_program/grass/zstd/zstd-1.5.2/lib/#COMMENTinclude/ \
        #COMMENT--with-zstd-libs=/mnt/GRASS_program/grass/zstd/zstd-1.5.2/lib/ \
        #COMMENT--with-gdal=/path/to/gdal-config  # This could be the path to a gdal #COMMENTversion compiled from source